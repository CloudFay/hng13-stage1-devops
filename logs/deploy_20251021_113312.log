üóÇ Logs will be saved in: ./logs/deploy_20251021_113312.log
[2025-10-21 11:33:12] üîß Collecting deployment parameters...
Enter Git Repository URL: Enter Personal Access Token (PAT): 
Enter Branch name (default: main): Enter Remote Server Username: Enter Remote Server IP Address: Enter SSH Key Path (e.g., ~/.ssh/id_rsa): Enter Application Port (internal container port): [2025-10-21 11:34:19] ‚úÖ User input collected successfully.
[2025-10-21 11:34:19] Repository: https://github.com/CloudFay/hng13-stage1-devops
[2025-10-21 11:34:19] Remote Server: ubuntu@13.60.50.143
[2025-10-21 11:34:19] Port: 5000
[2025-10-21 11:34:20] ÔøΩÔøΩ Starting repository cloning process...
[2025-10-21 11:34:20] üìÇ Repository 'hng13-stage1-devops' already exists. Pulling latest changes...
From https://github.com/CloudFay/hng13-stage1-devops
 * branch            main       -> FETCH_HEAD
Already on 'main'
Your branch is behind 'origin/main' by 1 commit, and can be fast-forwarded.
  (use "git pull" to update your local branch)
From https://github.com/CloudFay/hng13-stage1-devops
 * branch            main       -> FETCH_HEAD
Updating ca7773e..3c9d142
Fast-forward
 deploy.sh | 4 ++++
 1 file changed, 4 insertions(+)
[2025-10-21 11:34:22] üê≥ Dockerfile found ‚Äî OK.
[2025-10-21 11:34:22] ‚úÖ Repository cloned and verified successfully.
[2025-10-21 11:34:23] üîó Connecting to remote server: ubuntu@13.60.50.143 ...
Pseudo-terminal will not be allocated because stdin is not a terminal.
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.14.0-1011-aws x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Oct 21 10:34:25 UTC 2025

  System load:  0.0               Temperature:           -273.1 C
  Usage of /:   35.9% of 6.71GB   Processes:             123
  Memory usage: 35%               Users logged in:       1
  Swap usage:   0%                IPv4 address for ens5: 172.31.34.248


Expanded Security Maintenance for Applications is not enabled.

60 updates can be applied immediately.
35 of these updates are standard security updates.
To see these additional updates run: apt list --upgradable

1 additional security update can be applied with ESM Apps.
Learn more about enabling ESM Apps service at https://ubuntu.com/esm


üß∞ Updating packages and installing dependencies...

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Hit:1 http://eu-north-1.ec2.archive.ubuntu.com/ubuntu noble InRelease
Hit:2 http://eu-north-1.ec2.archive.ubuntu.com/ubuntu noble-updates InRelease
Hit:3 http://eu-north-1.ec2.archive.ubuntu.com/ubuntu noble-backports InRelease
Hit:4 http://security.ubuntu.com/ubuntu noble-security InRelease
Reading package lists...
Building dependency tree...
Reading state information...
55 packages can be upgraded. Run 'apt list --upgradable' to see them.

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Reading package lists...
Building dependency tree...
Reading state information...
docker.io is already the newest version (28.2.2-0ubuntu1~24.04.1).
docker-compose is already the newest version (1.29.2-6ubuntu1).
nginx is already the newest version (1.24.0-2ubuntu7.5).
curl is already the newest version (8.5.0-2ubuntu10.6).
0 upgraded, 0 newly installed, 0 to remove and 55 not upgraded.
‚úÖ Remote environment setup complete.
[2025-10-21 11:34:31] üì§ Transferring project files to remote server...
[2025-10-21 11:34:41] üöÄ Deploying application remotely...
Pseudo-terminal will not be allocated because stdin is not a terminal.
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.14.0-1011-aws x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Oct 21 10:34:25 UTC 2025

  System load:  0.0               Temperature:           -273.1 C
  Usage of /:   35.9% of 6.71GB   Processes:             123
  Memory usage: 35%               Users logged in:       1
  Swap usage:   0%                IPv4 address for ens5: 172.31.34.248

 * Ubuntu Pro delivers the most comprehensive open source security and
   compliance features.

   https://ubuntu.com/aws/pro

Expanded Security Maintenance for Applications is not enabled.

60 updates can be applied immediately.
35 of these updates are standard security updates.
To see these additional updates run: apt list --upgradable

1 additional security update can be applied with ESM Apps.
Learn more about enabling ESM Apps service at https://ubuntu.com/esm


myapp
myapp
üß± Using docker-compose for deployment...
Removing network app_default
Creating network "app_default" with the default driver
Building web
DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
            Install the buildx component to build images with BuildKit:
            https://docs.docker.com/go/buildx/

Sending build context to Docker daemon  15.87kB
Step 1/6 : FROM python:3.9-slim
 ---> 455962325b3b
Step 2/6 : WORKDIR /app
 ---> Using cache
 ---> 185d02a0e64b
Step 3/6 : COPY . /app
 ---> fc592f40f9e5
Step 4/6 : RUN pip install flask
 ---> Running in e99c1e876d25
Collecting flask
  Downloading flask-3.1.2-py3-none-any.whl (103 kB)
     ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 103.3/103.3 kB 8.7 MB/s eta 0:00:00
Collecting importlib-metadata>=3.6.0
  Downloading importlib_metadata-8.7.0-py3-none-any.whl (27 kB)
Collecting click>=8.1.3
  Downloading click-8.1.8-py3-none-any.whl (98 kB)
     ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 98.2/98.2 kB 14.8 MB/s eta 0:00:00
Collecting werkzeug>=3.1.0
  Downloading werkzeug-3.1.3-py3-none-any.whl (224 kB)
     ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 224.5/224.5 kB 28.2 MB/s eta 0:00:00
Collecting markupsafe>=2.1.1
  Downloading markupsafe-3.0.3-cp39-cp39-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (20 kB)
Collecting blinker>=1.9.0
  Downloading blinker-1.9.0-py3-none-any.whl (8.5 kB)
Collecting jinja2>=3.1.2
  Downloading jinja2-3.1.6-py3-none-any.whl (134 kB)
     ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 134.9/134.9 kB 19.6 MB/s eta 0:00:00
Collecting itsdangerous>=2.2.0
  Downloading itsdangerous-2.2.0-py3-none-any.whl (16 kB)
Collecting zipp>=3.20
  Downloading zipp-3.23.0-py3-none-any.whl (10 kB)
Installing collected packages: zipp, markupsafe, itsdangerous, click, blinker, werkzeug, jinja2, importlib-metadata, flask
Successfully installed blinker-1.9.0 click-8.1.8 flask-3.1.2 importlib-metadata-8.7.0 itsdangerous-2.2.0 jinja2-3.1.6 markupsafe-3.0.3 werkzeug-3.1.3 zipp-3.23.0
[91mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
[0m[91m
[notice] A new release of pip is available: 23.0.1 -> 25.2
[notice] To update, run: pip install --upgrade pip
[0m ---> Removed intermediate container e99c1e876d25
 ---> 8379332ab3b5
Step 5/6 : EXPOSE 5000
 ---> Running in de9e903287d8
 ---> Removed intermediate container de9e903287d8
 ---> ba7e59ad380f
Step 6/6 : CMD ["python", "app.py"]
 ---> Running in ec8df59250ad
 ---> Removed intermediate container ec8df59250ad
 ---> a209e1693ba2
Successfully built a209e1693ba2
Successfully tagged app_web:latest
Creating myapp ... 
Creating myapp ... done
‚úÖ Application deployed successfully!
[2025-10-21 11:35:02] ‚öôÔ∏è Configuring Nginx reverse proxy...
Pseudo-terminal will not be allocated because stdin is not a terminal.
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.14.0-1011-aws x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Oct 21 10:34:25 UTC 2025

  System load:  0.0               Temperature:           -273.1 C
  Usage of /:   35.9% of 6.71GB   Processes:             123
  Memory usage: 35%               Users logged in:       1
  Swap usage:   0%                IPv4 address for ens5: 172.31.34.248

 * Ubuntu Pro delivers the most comprehensive open source security and
   compliance features.

   https://ubuntu.com/aws/pro

Expanded Security Maintenance for Applications is not enabled.

60 updates can be applied immediately.
35 of these updates are standard security updates.
To see these additional updates run: apt list --upgradable

1 additional security update can be applied with ESM Apps.
Learn more about enabling ESM Apps service at https://ubuntu.com/esm


2025/10/21 10:35:05 [emerg] 6904#6904: invalid number of arguments in "proxy_set_header" directive in /etc/nginx/sites-enabled/myapp:7
nginx: configuration file /etc/nginx/nginx.conf test failed
‚úÖ Nginx proxy configured successfully.
Job for nginx.service failed.
See "systemctl status nginx.service" and "journalctl -xeu nginx.service" for details.
[2025-10-21 11:35:06] üß™ Validating deployment...
Pseudo-terminal will not be allocated because stdin is not a terminal.
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.14.0-1011-aws x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Oct 21 10:34:25 UTC 2025

  System load:  0.0               Temperature:           -273.1 C
  Usage of /:   35.9% of 6.71GB   Processes:             123
  Memory usage: 35%               Users logged in:       1
  Swap usage:   0%                IPv4 address for ens5: 172.31.34.248

 * Ubuntu Pro delivers the most comprehensive open source security and
   compliance features.

   https://ubuntu.com/aws/pro

Expanded Security Maintenance for Applications is not enabled.

60 updates can be applied immediately.
35 of these updates are standard security updates.
To see these additional updates run: apt list --upgradable

1 additional security update can be applied with ESM Apps.
Learn more about enabling ESM Apps service at https://ubuntu.com/esm


üîç Checking running containers...
CONTAINER ID   IMAGE     COMMAND           CREATED         STATUS         PORTS                                         NAMES
c5d0fd3b1826   app_web   "python app.py"   8 seconds ago   Up 7 seconds   0.0.0.0:5000->5000/tcp, [::]:5000->5000/tcp   myapp
üåê Testing application endpoint...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0 HTTP/1.1 200 OK
Server: nginx/1.24.0 (Ubuntu)
Date: Tue, 21 Oct 2025 10:35:09 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 49
Connection: keep-alive

   0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0    49    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0    49    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
[2025-10-21 11:35:09] ‚úÖ Deployment validation complete!
[2025-10-21 11:35:09] üßπ Cleaning up deployment resources...
Pseudo-terminal will not be allocated because stdin is not a terminal.
Welcome to Ubuntu 24.04.3 LTS (GNU/Linux 6.14.0-1011-aws x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

 System information as of Tue Oct 21 10:34:25 UTC 2025

  System load:  0.0               Temperature:           -273.1 C
  Usage of /:   35.9% of 6.71GB   Processes:             123
  Memory usage: 35%               Users logged in:       1
  Swap usage:   0%                IPv4 address for ens5: 172.31.34.248

 * Ubuntu Pro delivers the most comprehensive open source security and
   compliance features.

   https://ubuntu.com/aws/pro

Expanded Security Maintenance for Applications is not enabled.

60 updates can be applied immediately.
35 of these updates are standard security updates.
To see these additional updates run: apt list --upgradable

1 additional security update can be applied with ESM Apps.
Learn more about enabling ESM Apps service at https://ubuntu.com/esm


myapp
myapp
üßº Cleanup complete.
[2025-10-21 11:35:22] üöÄ Deployment process completed successfully!
